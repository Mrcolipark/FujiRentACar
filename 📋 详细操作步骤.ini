ğŸ“‹ è¯¦ç»†æ“ä½œæ­¥éª¤

  Step 1: è¿æ¥åˆ° Vultr æœåŠ¡å™¨

  åœ¨ä½ çš„ Mac ç»ˆç«¯æ‰§è¡Œï¼ˆæ›¿æ¢ YOUR_SERVER_IP ä¸ºå®é™…IPï¼‰ï¼š

  ssh root@YOUR_SERVER_IP

  é¦–æ¬¡è¿æ¥ä¼šæç¤ºè¾“å…¥å¯†ç ï¼ˆVultr é‚®ä»¶é‡Œåº”è¯¥æœ‰ï¼‰ã€‚

  ---
  Step 2: æœåŠ¡å™¨ç¯å¢ƒé…ç½®

  ç™»å½•æœåŠ¡å™¨åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

  # æ›´æ–°ç³»ç»Ÿ
  apt update && apt upgrade -y

  # å®‰è£… Nginx
  apt install nginx -y

  # å®‰è£… Node.js 20.x (ç”¨äºç¼–è¯‘é¡¹ç›®)
  curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
  apt install -y nodejs

  # å®‰è£… Certbot (ç”¨äº SSL è¯ä¹¦)
  apt install certbot python3-certbot-nginx -y

  # åˆ›å»ºç½‘ç«™ç›®å½•
  mkdir -p /var/www/rentacarfuji
  chown -R www-data:www-data /var/www/rentacarfuji

  # éªŒè¯å®‰è£…
  nginx -v
  node -v
  npm -v

  ---
  Step 3: åœ¨æœ¬åœ°ç¼–è¯‘é¡¹ç›®

  å›åˆ°ä½ çš„ Mac ç»ˆç«¯ï¼ˆä¸æ˜¯æœåŠ¡å™¨ç»ˆç«¯ï¼‰ï¼š

  cd /Users/yanmengru/Desktop/FujiRentACar/source/frontend

  # å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
  npm install

  # ç¼–è¯‘ç”Ÿäº§ç‰ˆæœ¬
  npm run build

  ç¼–è¯‘å®Œæˆåï¼Œä¼šç”Ÿæˆ dist ç›®å½•ã€‚

  ---
  Step 4: ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

  åœ¨ Mac ç»ˆç«¯æ‰§è¡Œï¼ˆæ›¿æ¢ YOUR_SERVER_IPï¼‰ï¼š

  cd /Users/yanmengru/Desktop/FujiRentACar/source/frontend

  # ä½¿ç”¨ rsync ä¸Šä¼ ï¼ˆæ¨èï¼‰
  rsync -avz --progress dist/ root@YOUR_SERVER_IP:/var/www/rentacarfuji/

  # æˆ–è€…ä½¿ç”¨ scpï¼ˆå¤‡é€‰ï¼‰
  # scp -r dist/* root@YOUR_SERVER_IP:/var/www/rentacarfuji/

  ---
  Step 5: é…ç½® Nginx

  å›åˆ°æœåŠ¡å™¨ç»ˆç«¯ï¼Œåˆ›å»º Nginx é…ç½®æ–‡ä»¶ï¼š

  nano /etc/nginx/sites-available/rentacarfuji

  ç²˜è´´ä»¥ä¸‹é…ç½®ï¼š

  server {
      listen 80;
      server_name rentacarfuji.com www.rentacarfuji.com;

      root /var/www/rentacarfuji;
      index index.html;

      # æ—¥å¿—é…ç½®
      access_log /var/log/nginx/rentacarfuji_access.log;
      error_log /var/log/nginx/rentacarfuji_error.log;

      # Gzip å‹ç¼©
      gzip on;
      gzip_vary on;
      gzip_min_length 1024;
      gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss
  application/json application/javascript;

      # é™æ€æ–‡ä»¶ç¼“å­˜
      location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
          expires 1y;
          add_header Cache-Control "public, immutable";
      }

      # React Router æ”¯æŒï¼ˆæ‰€æœ‰è·¯ç”±æŒ‡å‘ index.htmlï¼‰
      location / {
          try_files $uri $uri/ /index.html;
      }

      # data ç›®å½•ç‰¹æ®Šå¤„ç†
      location /data/ {
          add_header Cache-Control "no-cache";
          try_files $uri =404;
      }
  }

  ä¿å­˜å¹¶é€€å‡ºï¼ˆæŒ‰ Ctrl+Xï¼Œç„¶å Yï¼Œå†æŒ‰ Enterï¼‰ã€‚

  ---
  Step 6: å¯ç”¨é…ç½®å¹¶æµ‹è¯•

  # åˆ›å»ºè½¯é“¾æ¥
  ln -s /etc/nginx/sites-available/rentacarfuji /etc/nginx/sites-enabled/

  # åˆ é™¤é»˜è®¤é…ç½®ï¼ˆå¯é€‰ï¼‰
  rm /etc/nginx/sites-enabled/default

  # æµ‹è¯• Nginx é…ç½®
  nginx -t

  # é‡å¯ Nginx
  systemctl restart nginx

  # è®¾ç½®å¼€æœºè‡ªå¯
  systemctl enable nginx

  # æ£€æŸ¥çŠ¶æ€
  systemctl status nginx

  ---
  Step 7: é…ç½® Cloudflare DNS

  1. ç™»å½• Cloudflare: https://dash.cloudflare.com/
  2. é€‰æ‹©åŸŸå: rentacarfuji.com
  3. æ·»åŠ  DNS è®°å½•:

  ç±»å‹: A
  åç§°: @
  å†…å®¹: YOUR_VULTR_SERVER_IP
  ä»£ç†çŠ¶æ€: ä»…DNSï¼ˆç°è‰²äº‘æœµï¼‰âš ï¸ å…ˆä¸è¦å¼€ä»£ç†

  ç±»å‹: A
  åç§°: www
  å†…å®¹: YOUR_VULTR_SERVER_IP
  ä»£ç†çŠ¶æ€: ä»…DNSï¼ˆç°è‰²äº‘æœµï¼‰

  é‡è¦ï¼šæš‚æ—¶å…³é—­ Cloudflare ä»£ç†ï¼ˆç°è‰²äº‘æœµï¼‰ï¼Œç­‰ SSL è¯ä¹¦é…ç½®å®Œæˆåå†å¼€å¯ã€‚

  ---
  Step 8: é…ç½® SSL è¯ä¹¦

  å›åˆ°æœåŠ¡å™¨ç»ˆç«¯ï¼š

  # è‡ªåŠ¨é…ç½® SSL è¯ä¹¦
  certbot --nginx -d rentacarfuji.com -d www.rentacarfuji.com

  # æŒ‰æç¤ºæ“ä½œï¼š
  # 1. è¾“å…¥é‚®ç®±åœ°å€
  # 2. åŒæ„æœåŠ¡æ¡æ¬¾ (Y)
  # 3. é€‰æ‹©æ˜¯å¦å…±äº«é‚®ç®± (N)
  # 4. é€‰æ‹©é‡å®šå‘ HTTP åˆ° HTTPS (2)

  è¯ä¹¦ä¼šè‡ªåŠ¨ç»­æœŸï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

  ---
  Step 9: å¼€å¯ Cloudflare CDNï¼ˆå¯é€‰ï¼‰

  SSL é…ç½®å®Œæˆåï¼Œå›åˆ° Cloudflareï¼š

  1. å°† DNS è®°å½•çš„ä»£ç†çŠ¶æ€æ”¹ä¸ºå·²ä»£ç†ï¼ˆæ©™è‰²äº‘æœµï¼‰
  2. åœ¨ SSL/TLS è®¾ç½®ä¸­ï¼Œé€‰æ‹© Full (strict)

  ---
  Step 10: æµ‹è¯•ç½‘ç«™

  åœ¨æµè§ˆå™¨è®¿é—®ï¼š
  - http://rentacarfuji.com â†’ åº”è¯¥è‡ªåŠ¨è·³è½¬åˆ° https
  - https://rentacarfuji.com â†’ æ˜¾ç¤ºç½‘ç«™å†…å®¹

  ---
  ğŸ”„ åç»­æ›´æ–°æµç¨‹

  å½“ä½ ä¿®æ”¹ä»£ç åï¼Œåªéœ€æ‰§è¡Œï¼š

  # æœ¬åœ°ç¼–è¯‘
  cd /Users/yanmengru/Desktop/FujiRentACar/source/frontend
  npm run build

  # ä¸Šä¼ åˆ°æœåŠ¡å™¨
  rsync -avz --progress dist/ root@YOUR_SERVER_IP:/var/www/rentacarfuji/

  # æ¸…é™¤ Nginx ç¼“å­˜ï¼ˆå¦‚éœ€è¦ï¼‰
  ssh root@YOUR_SERVER_IP "systemctl reload nginx"
